function isMoveValid(piece, fromSquare, toSquare) {
  // improved implementation code here
  // now checks for checkmate, stalemate, and en passant scenarios
}