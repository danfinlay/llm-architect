- What would it mean to have [[Delegatable Eth]] work with [[[[EIP]] 4337: [[account abstraction (AA)]] via Entry Point Contract]]?
- Pros
    - All the benefits of [[Delegatable Eth]] but able to use any contract account, not just an [[externally owned account (EOA)]]
    - Introduces the ability for the txs to be paid for with tokens via [[[[EIP]] 4337: [[account abstraction (AA)]] via Entry Point Contract]]
- Cons
    - The average application wouldn't know how to "receive" the delegations. [[should [[evm]] delegations exist at the app layer or the account layer?]]
- What it would take to combine the two
    - [a minimal 4337 account contract](https://github.com/eth-infinitism/account-abstraction/blob/develop/contracts/core/BaseAccount.sol)
        - Currently has some assumptions that are not compatible with Delegatable
            - Has a normal type nonce.
    - Need to create a 
    - Another puzzle: Today, delegations are simply signed with an EOA. Post-4337, what do we do?
        - In the [1271 support branch](https://github.com/delegatable/delegatable-sol/pull/34), we ask the signing account if it meant to "sign" this delegation.
        - We could possibly just reuse that 1271 check for 4337 also.
        - Should delegations also be UserOperations?
            - If they are, doesn't that imply they get executed? Does that mean they must have their results recorded on chain? Does that make them cost more gas? (probably!)
    - accept 4337 relay batches 
        - Instead of its own processInvocations method.
    - Rename Invocations to UserOperations? Or find a reasonable way to embed an invocation in user operations.
    - use 4337 style auth checks (not just [[ecdsa]])
        - Maybe have a way to support either?
    - implement `validateUserOp
    (UserOperation calldata userOp, uint requiredPrefund)`
        - This method only really makes sense in a context where the operation is triggering a trnsaction itself.
        - Needs to be configured to trust the global 4337 batching contract.
        - Maybe make each signature type for Delegatable into a function instead
            - delegate()
- How an external account type makes itself compatible
    - To be able to delegate its own capabilities
        - Needs to implement/inherit the `invoke()` method
        - Needs to use the [[the _msgSender() trick]] to permit delegations.
    - In order to be able to transitively delegate delegations it has received
        - Needs to have some mechanism by which it can approve a delegation-type [[User Operation]]
- [[roam/comments]]
    - [[October 13th, 2022]]
        - [[Dan Finlay]]
            - What it would take to combine the two
                - 
