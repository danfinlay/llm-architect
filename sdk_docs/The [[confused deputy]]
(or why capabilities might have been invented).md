- By [[Norm Hardy]]
- [Full text](https://dl.acm.org/doi/10.1145/54289.871709)
    - {{pdf: https://firebasestorage.googleapis.com/v0/b/firescript-577a2.appspot.com/o/imgs%2Fapp%2Fcapabul%2Fju7wMpeH3V.pdf?alt=media&token=03e79b53-492e-4642-9b83-20b33a237329}}
- Notes
    - System setup
        - SYSX: the home directroy
            - FORT
                - The compiler.
                - Would only run if the 
            - STAT
                - A file collecting statistics about compiler language feature usage.
            - Home license files that mark that the OS should let a given program to write in its home directory.
            - BILL
                - Billing information
    - Problem
        - Ultimately allowed a user to target the BILL file as the STAT target, overwriting the billing information.
    - Possible mitigations
        - Keep amending the compiler to reflect more and more files it isn't allowed to overwrite.
            - Keeps growing complex, and can break legitimate programs.
        - The system was modified to allow the program to "switch hats", to select subsets of its authority
            - Increases complexity.
            - Did not scale to even more authorities, and types of authority besides files.
    - Conclusion
        - The compiler runs with authority from two sources, making it a [[confused deputy]]
            - The invoker, yielding their own authority to run the compiler.
            - Home license files that mark that the OS should let a given program to write in its home directory.
        - The compiler has no way to keep its two sources of authority apart.
            - When it writes statistics it intends to use the authority granted by its home files license.
            - When it produces debugging output it intends to use authority from its invoker.
        - There was concern that a capability system would be more complex to build correctly, but ended up reducing a lot of security logic from the normal code.
        - Some systems tried to add capabilities to the traditional mechanisms and sometimes suffered more from the combined disadvantages than benefited from the combined advantages. Our view is that capabilities must be the foundation of the system. We have carried out that program more completely in some ways in our implementation of the [[KeyKOS]] system [1, 2] than previous systems have. KeyKOS has directories and other such traditional operating system facilities--they are implemented and accessed, however, via capabilities
        - A capability makes it simple to specify the target of an operation, because the target is specified with the authority to do so, no additional validation is needed.
        - Performance also worked well.
        - Targets of operations are never referred to with strings, since those introduce the need for access tables on a per-agent basis.
            - Each time a new external domain is added, any function that specifies the target of an operation by string requires an additional row in an access list.
            - Each time a new sensitive target is added that should be restricted by default, a new restriction needs to be (retroactively?) added to the access lists for all existing agents.
                - This introduces the possibility of new conflicts: The system can add a new restricted field that formerly an authorized agent had interacted with.
- Implications for extensible systems like [[[[MetaMask]] Snaps]]
    - A snap itself is a potentially confusible deputy, and juggles authority from many sources
        - It may have some endowments from the user, which represent what it is allowed to access and do from the system.
        - It may be connected to from any number of external domains, each of which may need to have its own attenuated authority to some of that snap's functionality.
