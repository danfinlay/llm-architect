- ![](https://firebasestorage.googleapis.com/v0/b/firescript-577a2.appspot.com/o/imgs%2Fapp%2Fcapabul%2FcMHbi73JpY.19.55%20PM.png?alt=media&token=9c206095-a429-44eb-9147-430786201a0a)
- A [[web3 of trust]] designed to report and flag [[phishing]] on twitter using [[Delegatable Eth]].
- May soon evolve to [[[[Delegatable Eth]] Claims]]
- [Code on GitHub](https://github.com/danfinlay/MobyMask/)
- [Deployed on Ethereum mainnet at mobymask.eth: 0xb06e6db9288324738f04fcaac910f5a60102c1f8](https://etherscan.io/address/0xb06e6db9288324738f04fcaac910f5a60102c1f8)
- [Grant funds available from 0xddb18b319be3530560eecff962032dfad88212d4](https://etherscan.io/address/0xddb18b319be3530560eecff962032dfad88212d4)
- Motivation
    - Phishing is terrible on twitter today.
    - You can't say "MetaMask" on Twitter without being barraged by phisher bots offering fake support.
    - Spam bots are 5-10% of [[Twitter]] accounts https://www.bloomberg.com/opinion/articles/2022-05-17/elon-musk-does-not-care-about-spam-bots
    - 81.73% of all [[MetaMask]] [[customer support]] tickets for the last 365 days is related to "reporting a scam or phishing site". ([Internal source](https://consensysus.cloud.looker.com/dashboards/8?Created%20Date=365%20day&Name=MetaMask)), h/t to [[Conor Fallon]]
- Experience
    - ![](https://firebasestorage.googleapis.com/v0/b/firescript-577a2.appspot.com/o/imgs%2Fapp%2Fcapabul%2Fru7poPHQSo.49.36%20PM.png?alt=media&token=34498321-f215-4acb-ae47-b7d9a7eb32f2)
    - People "in the network" get a badge!!: tiny white whale
    - Intro page copy
        - Welcome, you have been invited to an experimental system for detecting phishers as a group, using a revokable tree of invitations. Each MobyMask whale is able to report phishers, unflag reports, invite new whales, and revoke their invitations.
        - For now we are trying to wipe out twitter scams. You can report or invite any account by clicking the three dots on any post by that account, like this:
            - ![](https://firebasestorage.googleapis.com/v0/b/firescript-577a2.appspot.com/o/imgs%2Fapp%2Fcapabul%2FIT9bMvadqb.56.29%20PM.png?alt=media&token=12e335ba-2c91-4312-b996-d0f6229e605b)
        - If you report a scam that is disputed by someone "upstream" of your invitation, you may have your membership revoked along with everyone you have invited, so please only report things that are definitely trying to steal money through impersonation.
        - If this experiment works, we may invite you to give input in other ways, but first we just want to clean up the web of all these scams, so please, don't try to censor people you disagree with, and help us see if we can work together to keep the phishers at bay.
    - What's the flow for non-invited people?
        - On flagging: BOTH report, AND draft comment 
            - > I've flagged this person as a scammer with MobyMask. We're trying to use web3 to clean up the web. You can subscribe to our warnings by installing MobyMask on your browser now: [link]
    - ![](https://firebasestorage.googleapis.com/v0/b/firescript-577a2.appspot.com/o/imgs%2Fapp%2Fcapabul%2FpdZAcKIcuG.57.40%20PM.png?alt=media&token=1b52985e-0ebe-4f74-ac32-561dc1cae912)
    - Reported twitter users should immediately be marked as scammers (or hidden)
    - Reported sites should now show a warning page (and maybe a "mark as not a scam" view).
    - Users can review any conflicts that their invited users are involved in.
- Planning
    - {{kanban}}
        - backlog
            - Write JS for validating & comprehending a signed eth invocation
            - Make a server that stores claims counterfactually
                - May actually just emulate the smart contract in JS b/c caching will suck in the meanwhile until we have [[Laconic]].
                - May use [[[[ganache]] fork]] once we have a good local cache like [[Laconic]]
            - Make the server self-hostable and gossip the claims
            - [ ] make webextension that adds report phisher and invite user to browser context menu. or edit dom and add to twitter menu. can we fill twitter dm from query params? Direct Message button | Docs | Twitter Developer Platform
            - [ ] in case of conflicts, do not block, but trigger review.
            - [ ] make admin dashboard for viewing conflicts
            - Enable users to report more types of accounts (sites, Discord, YouTube, eth address, etc...)
            - Cache and distribute access to the list in a scalable way
            - Integrate "listeners" to the system wherever bad actors are a problem.
        - in progress
        - done
            - [ ] fork delegatable
            - [ ] write js delegation validator (can employ ganache)
            - [ ] write server that validates submitted delegations and rate limits bad ones, stores to db
            - [ ] write code for issuing simple revocable right to edit phishing entries
            - [ ] write ui for delegating to eth address
            - [ ] wrote ui to copy invite link
            - [ ] make invited onboarding page.
            - [ ] invite link should go to page to place cookie so the extension could be passed it la
            - [ ] let each user view their outstanding permissions so they can easily revoke
- Architecture
    - Contract
        - ```solidity
contract PhisherList is Ownable, Delegatable {
  mapping (string => bool) isPhisher;
  function claimIfPhisher (string identifier, bool isAccused) onlyOwner {
    isPhisher[identifier] = isAccused;
  }
}```
    - Backend
        - The contract can be deployed to a very cheap chain, maybe proof of stake, maybe one dedicated to this purpose, since it could get data-intensive.
        - Identifiers are strings that can embed multiple encoding types, and can be arbitrarily extended.
            - URL:{url}
            - TWT:{twitter handle}
            - ETH:{eth address}
        - By default, invite links could be made as `user.signDelegation(toPubKey) + privKey`, so the recipient doesn't need a wallet (or any confirmations) to start submitting reports and inviting others.
        - Signed invocations can be sent to a backend, for batching and submission by a central server.
        - If inviting a user by eth address, the delegation can be made directly to that recipient's address.
        - A user could optionally link their extension to their MetaMask/wallet to use their "main" key directly for this, but honestly, might just not be needed.
        - There would need to be monitoring of behavior of the graph
            - A contentious ID (people alternating voting it scam/not-scam) would need some intervention. To start, the founding team ideally has a dashboard of top contentious names, make a ruling, and revoke the invitation to whatever branch is causing the incorrect call.
            - Eventually, any user should be able to participate in adjudicating disputes:
                - One of your invites has participated in a controversial phishing report. Review?
                - If they have marked this incorrectly, you could lose your privileges as a trusted reporter as a result. Would you like to revoke your invitation to them?
            - If certain IPs were spamming reports, they would need to be rate limited, or have their delegation branch revoked.
        - While the service would ship with a centrally moderated scam contract, users should be able to add/remove any scam contract to their extension, so people could subscribe to different kinds of lists of things that they might want to avoid.
            - The extension could then let a user choose (upon reporting) which list they are accusing an entity of being, so it would be easy to keep many metadata lists live.
- MobyMask: The Hackathon Presentation
    - Problem statement
        - Phishers are horrendous, and run rampant.
        - ~80% of MetaMask user tickets are related to users trying to report phishers.
        - We struggle to keep our phishing lists up to date.
        - Web2 companies are failing to solve this.
    - Solution
        - Using [[Delegatable Eth]]
        - A simple phisher registry with an invite & revoke system.
        - An option to draw from this registry in browser extensions or anywhere else.
    - Current features
        - [[SoulBound Tokens (SBT)]] with [[delegation]]
        - Invite trees: 4 deep due to URL length limits
        - Supports revocation
        - Uses MetaTransactions for every operation
        - Supports batched reports to save gas
        - Uses a new react component I made called [[LazyConnect]] for lazy wallet onboarding
            - Lets the user get started right away
            - User can queue up phishing reports without a wallet, without any gas.
            - User can invite others with no gas or wallet or any registration.
            - Submitting phishing reports takes gas.
            - Revoking invitations takes gas.
    - Demo
    - Wrap-up
        - Gas analysis
            - Revocation cost 66k gas: https://goerli.etherscan.io/tx/0xfe043c2934106e59cd4b658aae53f414279beef66e290bde5b9ebd973c575379
            - Batch of 3 reports from a tier 1 member was 223k gas, or 74k gas per report: https://goerli.etherscan.io/tx/0x005313d17da8f5aa2c886d1d98507cc6a6fa322d0c01e3a5ad7c37fdfcf20ab4
            - A basic token transfer (tether): 63k gas: https://etherscan.io/tx/0xf25bab09acccd3f4870953655090105587cd1085eb05cbf810b5c2f958e6d8d0
        - Future
            - Link shortening for longer invite chains
            - Reviewing activity of invites for accountability in dispute resolution.
            - Counterfactualization
                - So the phishing reports will be made out of all of these “invocation” messages which are independently validatable given access to the blockchain, even without mining them.
                - There is an opportunity for us to make the phishing registry __counterfactual__, where users run a truffle --fork node locally where they process outstanding invocations, and so derive a valid set of phishing reports.
                - This would allow the system to __only submit revocations to the blockchain__, which I think could make the entire system so cheap that it would be worth running on mainnet.
                - This system would also be generally useful: It could be applied to any delegatable-eth project, and would be a powerful tool for building chain-minimal applications. If ganache were made to run in a snap or in the wallet, this service could be made to run in the wallet, too.
                - For this to be performant, the peers would need to be able to run a local evm that is able to operate on a local cached copy of the state they care about, like with [[Laconic]]
            - As a [[[[MetaMask]] Snaps]]
                - Enabling portability with no central site.
                - Enabling open ended caveats when delegating.
                - Allow displaying these permissions as assets, with images and all.
                - Selective disclosure to other services
            - Gossip Layer
                - Would benefit from a [[p2p]] gossip layer for distributing reports.
            - As login policy for chat access
            - As a [[[[EIP 2535 Diamond Standard]] facet]]
            - Flagging sites and other kinds of accounts.
            - Adding endorsements
            - Ability to add additional roots of trust,  including ones that are on self-signed blockchains.
            - Option for claims to be valid on multiple roots of trust.
- Additional steps
